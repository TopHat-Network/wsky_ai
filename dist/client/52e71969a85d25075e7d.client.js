(()=>{"use strict";var e={979:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var s=Object.getOwnPropertyDescriptor(t,o);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,s)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(o(99)),r=["a_m_m_fatlatin_01","a_m_m_socenlat_01","a_m_m_stlat_02","a_m_y_latino_01","a_m_y_stlat_01"],l="TAXI";RegisterCommand("taxi",(async()=>{console.log("step 1");let e=0;const t=PlayerPedId();if(!t)return void a.errorMsg("Player not found");console.log("step 2");const[o,n,s]=GetEntityCoords(t,!0),i=GetFirstBlipInfoId(8);if(!i)return void a.errorMsg("No waypoint found");console.log("step 3");const[c,d]=GetBlipInfoIdCoord(i),g=GetHeightmapBottomZForPosition(c,d);console.log("step 4");const[u,h]=await a.generateVehicle(l,[o,n,s],GetEntityHeading(t),r[Math.floor(Math.random()*r.length)]);console.log("step 5");const p=GetVehicleModelNumberOfSeats(l)-2;SetPedIntoVehicle(t,u,p),TaskVehicleDriveToCoordLongrange(h,u,c,d,g,22,787245,0),console.log("step 6");do{console.log("step 7");const t=Math.max(11,GetEntitySpeed(u)),[o,n,s]=GetEntityCoords(u,!0),i=CalculateTravelDistanceBetweenPoints(c,d,g,o,n,s),r=i/t;e=r/60,console.log({vehicleSpeed:t,distanceRemaining:i,timeRemainingInSeconds:r,estimatedArrivalInMinutes:e}),await a.Delay(500)}while(!a.hasVehicleArrivedAtDestination(u,[c,d,g])&&IsPedSittingInVehicle(t,u)&&IsPedSittingInVehicle(h,u));if(!IsPedSittingInVehicle(t,u))return a.infoMsg("Journey ended early - you left the vehicle"),SetVehicleAsNoLongerNeeded(u),void SetPedAsNoLongerNeeded(h);const f=a.getLocationFromCoords(c,d,g);a.successMsg(`You have arrived at ${f}.`),console.log("parking vehicle");const _=GetEntityHeading(u);TaskVehiclePark(h,u,c,d,g,_,0,20,!0);do{await a.Delay(50)}while(!IsVehicleStopped(u));console.log("Player leaving vehicle"),TaskLeaveVehicle(t,u,0);do{await a.Delay(500)}while(!IsPedSittingInVehicle(t,u));console.log("Setting Vehicle and Driver as no longer needed"),SetVehicleAsNoLongerNeeded(u),SetPedAsNoLongerNeeded(h)}),!1)},99:(e,t)=>{async function o(e){new Promise((t=>setTimeout(t,e)))}function n(e,t){const[o,n,s]=e,[i,a,r]=t;return Math.sqrt(Math.pow(o-i,2)+Math.pow(n-a,2)+Math.pow(s-r,2))}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocationFromCoords=t.hasVehicleArrivedAtDestination=t.getDistance=t.generateVehicle=t.successMsg=t.infoMsg=t.errorMsg=t.Delay=void 0,t.Delay=o,t.errorMsg=function(e){emit("chat:addMessage",{args:["Error",e],color:[255,0,0]})},t.infoMsg=function(e){emit("chat:addMessage",{args:["Info",e],color:[0,255,255]})},t.successMsg=function(e){emit("chat:addMessage",{args:["Success",e],color:[0,255,0]})},AddRelationshipGroup("WSKY_TAXI_DRIVER"),SetRelationshipBetweenGroups(0,GetHashKey("WSKY_TAXI_DRIVER"),GetHashKey("PLAYER")),SetRelationshipBetweenGroups(0,GetHashKey("PLAYER"),GetHashKey("WSKY_TAXI_DRIVER")),t.generateVehicle=async function(e,t,n,s){console.log("step 1");const[i,a,r]=t;RequestModel(e),console.log("step 2");do{await o(500)}while(!HasModelLoaded(e));if(console.log("step 3"),s){RequestModel(s),console.log("step 3.1");do{await o(500)}while(!HasModelLoaded(s));console.log("step 3.2")}console.log("step 4");const l=CreateVehicle(GetHashKey(e),i,a,r,n||0,!0,!0);let c=null;return console.log("step 5"),s&&(console.log("step 5.1"),c=CreatePedInsideVehicle(l,4,s,-1,!0,!0),SetPedRelationshipGroupHash(c,GetHashKey("WSKY_TAXI_DRIVER")),TaskSetBlockingOfNonTemporaryEvents(c,!0),console.log("step 5.2")),c?[l,c]:[l]},t.getDistance=n,t.hasVehicleArrivedAtDestination=function(e,t){return n(GetEntityCoords(e,!0),t)<=30},t.getLocationFromCoords=function(e,t,o){const n=GetNameOfZone(e,t,o),s=n?GetLabelText(n):null,[i]=GetStreetNameAtCoord(e,t,o),a=GetStreetNameFromHashKey(i);let r="your destination";return a&&(r=a),a&&s?r=`${a}, ${s}`:s&&(r=s),r}}},t={};!function o(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}(979)})();