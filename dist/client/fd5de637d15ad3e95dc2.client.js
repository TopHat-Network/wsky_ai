(()=>{var e={979:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t},r=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=s(o(99)),l=["a_m_m_fatlatin_01","a_m_m_socenlat_01","a_m_m_stlat_02","a_m_y_latino_01","a_m_y_stlat_01"],c="TAXI";RegisterCommand("taxi",(()=>r(void 0,void 0,void 0,(function*(){console.log("step 1");let e=0;const t=PlayerPedId();if(!t)return void a.errorMsg("Player not found");console.log("step 2");const[o,n,i]=GetEntityCoords(t,!0),s=GetFirstBlipInfoId(8);if(!s)return void a.errorMsg("No waypoint found");console.log("step 3");const[r,d]=GetBlipInfoIdCoord(s),u=GetHeightmapBottomZForPosition(r,d);console.log("step 4");const[h,g]=yield a.generateVehicle(c,[o,n,i],GetEntityHeading(t),l[Math.floor(Math.random()*l.length)]);console.log("step 5");const f=GetVehicleModelNumberOfSeats(c)-2;for(SetPedIntoVehicle(t,h,f),TaskVehicleDriveToCoordLongrange(g,h,r,d,u,22,787245,0),console.log("step 6");!a.hasVehicleArrivedAtDestination(h,[r,d,u])&&IsPedSittingInVehicle(t,h)&&IsPedSittingInVehicle(g,h);){console.log("step 7");const t=Math.max(11,GetEntitySpeed(h)),[o,n,i]=GetEntityCoords(h,!0),s=CalculateTravelDistanceBetweenPoints(r,d,u,o,n,i),l=s/t;e=l/60,console.log({vehicleSpeed:t,distanceRemaining:s,timeRemainingInSeconds:l,estimatedArrivalInMinutes:e}),yield a.Delay(500)}if(!IsPedSittingInVehicle(t,h))return a.infoMsg("Journey ended early - you left the vehicle"),SetVehicleAsNoLongerNeeded(h),void SetPedAsNoLongerNeeded(g);const p=a.getLocationFromCoords(r,d,u);a.successMsg(`You have arrived at ${p}.`),console.log("parking vehicle");const y=GetEntityHeading(h);for(TaskVehiclePark(g,h,r,d,u,y,0,20,!0);!IsVehicleStopped(h);)yield a.Delay(50);for(console.log("Player leaving vehicle"),TaskLeaveVehicle(t,h,0);!IsPedSittingInVehicle(t,h);)yield a.Delay(500);console.log("Setting Vehicle and Driver as no longer needed"),SetVehicleAsNoLongerNeeded(h),SetPedAsNoLongerNeeded(g)}))),!1)},99:function(e,t){"use strict";var o=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};function n(e){return o(this,void 0,void 0,(function*(){new Promise((t=>setTimeout(t,e)))}))}function i(e,t){const[o,n,i]=e,[s,r,a]=t;return Math.sqrt(Math.pow(o-s,2)+Math.pow(n-r,2)+Math.pow(i-a,2))}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocationFromCoords=t.hasVehicleArrivedAtDestination=t.getDistance=t.generateVehicle=t.successMsg=t.infoMsg=t.errorMsg=t.Delay=void 0,t.Delay=n,t.errorMsg=function(e){emit("chat:addMessage",{args:["Error",e],color:[255,0,0]})},t.infoMsg=function(e){emit("chat:addMessage",{args:["Info",e],color:[0,255,255]})},t.successMsg=function(e){emit("chat:addMessage",{args:["Success",e],color:[0,255,0]})},AddRelationshipGroup("WSKY_TAXI_DRIVER"),SetRelationshipBetweenGroups(0,GetHashKey("WSKY_TAXI_DRIVER"),GetHashKey("PLAYER")),SetRelationshipBetweenGroups(0,GetHashKey("PLAYER"),GetHashKey("WSKY_TAXI_DRIVER")),t.generateVehicle=function(e,t,i,s){return o(this,void 0,void 0,(function*(){console.log("step 1");const[o,r,a]=t;for(RequestModel(e),console.log("step 2");!HasModelLoaded(e);)yield n(500);if(console.log("step 3"),s){for(RequestModel(s),console.log("step 3.1");!HasModelLoaded(s);)yield n(500);console.log("step 3.2")}console.log("step 4");const l=CreateVehicle(GetHashKey(e),o,r,a,i||0,!0,!0);let c=null;return console.log("step 5"),s&&(console.log("step 5.1"),c=CreatePedInsideVehicle(l,4,s,-1,!0,!0),SetPedRelationshipGroupHash(c,GetHashKey("WSKY_TAXI_DRIVER")),TaskSetBlockingOfNonTemporaryEvents(c,!0),console.log("step 5.2")),c?[l,c]:[l]}))},t.getDistance=i,t.hasVehicleArrivedAtDestination=function(e,t){return i(GetEntityCoords(e,!0),t)<=30},t.getLocationFromCoords=function(e,t,o){const n=GetNameOfZone(e,t,o),i=n?GetLabelText(n):null,[s]=GetStreetNameAtCoord(e,t,o),r=GetStreetNameFromHashKey(s);let a="your destination";return r&&(a=r),r&&i?a=`${r}, ${i}`:i&&(a=i),a}}},t={};!function o(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,o),s.exports}(979)})();